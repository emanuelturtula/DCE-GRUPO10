Version 4
SHEET 1 7808 3776
WIRE 1232 -1808 1232 -1840
WIRE 1408 -1808 1408 -1840
WIRE 1568 -1808 1568 -1840
WIRE 1232 -1664 1232 -1728
WIRE 1408 -1664 1408 -1728
WIRE 1408 -1664 1232 -1664
WIRE 1568 -1664 1568 -1728
WIRE 1568 -1664 1408 -1664
WIRE 1696 -1664 1568 -1664
WIRE 1232 -1632 1232 -1664
WIRE 1408 -1632 1408 -1664
WIRE 1568 -1632 1568 -1664
WIRE 1696 -1616 1696 -1664
WIRE 1232 -1520 1232 -1552
WIRE 1408 -1520 1408 -1552
WIRE 1568 -1520 1568 -1552
WIRE 3312 -1120 3216 -1120
WIRE 3520 -1120 3376 -1120
WIRE 3216 -992 3216 -1120
WIRE 3216 -992 0 -992
WIRE 3248 -992 3216 -992
WIRE 3392 -992 3328 -992
WIRE 3520 -992 3520 -1120
WIRE 3520 -992 3472 -992
WIRE 4560 -992 3520 -992
WIRE 3216 -912 3216 -992
WIRE 3216 -784 3216 -832
WIRE 0 -480 0 -992
WIRE 0 -288 0 -400
WIRE 96 -288 0 -288
WIRE 304 -288 176 -288
WIRE 3712 -256 3392 -256
WIRE 3392 -224 3392 -256
WIRE 3344 -208 2624 -208
WIRE 3344 -160 3264 -160
WIRE 528 -144 464 -144
WIRE 688 -144 592 -144
WIRE 144 -96 144 -160
WIRE 3264 -96 3264 -160
WIRE 0 -80 0 -288
WIRE 112 -80 0 -80
WIRE 304 -64 304 -288
WIRE 304 -64 176 -64
WIRE 464 -64 464 -144
WIRE 464 -64 304 -64
WIRE 528 -64 464 -64
WIRE 688 -64 688 -144
WIRE 688 -64 608 -64
WIRE 848 -64 688 -64
WIRE 896 -64 848 -64
WIRE -672 -48 -720 -48
WIRE -160 -48 -672 -48
WIRE 0 -48 -80 -48
WIRE 112 -48 0 -48
WIRE 2624 -48 2624 -208
WIRE 2624 -48 2048 -48
WIRE 688 0 688 -64
WIRE -720 16 -720 -48
WIRE 0 16 0 -48
WIRE 144 16 144 -32
WIRE 2048 32 2048 -48
WIRE 3392 32 3392 -144
WIRE 3872 32 3392 32
WIRE 4032 32 3952 32
WIRE 4560 32 4560 -992
WIRE 4560 32 4032 32
WIRE 4864 32 4560 32
WIRE 4912 32 4864 32
WIRE 4912 48 4912 32
WIRE 4032 80 4032 32
WIRE -720 128 -720 96
WIRE 0 144 0 96
WIRE 688 144 688 80
WIRE 2048 176 2048 112
WIRE 4912 176 4912 128
WIRE 3392 192 3392 32
WIRE 4032 192 4032 144
WIRE 2624 208 2624 -48
WIRE 3344 208 2624 208
WIRE 3344 256 3216 256
WIRE 3216 336 3216 256
WIRE 3392 384 3392 272
WIRE 3712 384 3392 384
WIRE 3216 400 3216 336
WIRE 1504 944 1504 864
WIRE 1728 944 1696 944
WIRE 3136 960 3136 864
WIRE 3136 960 2800 960
WIRE 3376 960 3136 960
WIRE 1728 992 1728 944
WIRE 2800 1024 2800 960
WIRE 3136 1024 3136 960
WIRE 1696 1040 1696 944
WIRE 1504 1056 1504 1024
WIRE 1664 1056 1504 1056
WIRE 1856 1072 1728 1072
WIRE 1504 1088 1504 1056
WIRE 1664 1088 1632 1088
WIRE 2224 1088 2224 1024
WIRE 1696 1152 1696 1104
WIRE 2800 1152 2800 1104
WIRE 3136 1152 3136 1104
WIRE 3376 1152 3376 960
WIRE 2096 1168 2096 1136
WIRE 1856 1184 1856 1072
WIRE 2064 1184 1856 1184
WIRE 1504 1200 1504 1168
WIRE 2224 1200 2224 1168
WIRE 2224 1200 2128 1200
WIRE 2640 1200 2224 1200
WIRE 2928 1200 2864 1200
WIRE 3072 1200 2928 1200
WIRE 3312 1200 3072 1200
WIRE 1632 1216 1632 1088
WIRE 1696 1216 1632 1216
WIRE 1856 1216 1856 1184
WIRE 1856 1216 1776 1216
WIRE 2064 1216 2016 1216
WIRE 2096 1248 2096 1232
WIRE 2128 1248 2128 1216
WIRE 2128 1248 2096 1248
WIRE 1632 1264 1632 1216
WIRE 2096 1264 2096 1248
WIRE 2928 1280 2928 1200
WIRE 3136 1296 3136 1248
WIRE 2016 1312 2016 1216
WIRE 2016 1312 1936 1312
WIRE 2800 1328 2800 1248
WIRE 2864 1328 2800 1328
WIRE 2096 1344 2096 1328
WIRE 3376 1344 3376 1248
WIRE 3376 1344 3200 1344
WIRE 2016 1360 2016 1312
WIRE 2064 1360 2016 1360
WIRE 3888 1360 3840 1360
WIRE 2224 1376 2128 1376
WIRE 2384 1376 2224 1376
WIRE 1632 1392 1632 1344
WIRE 2064 1392 1632 1392
WIRE 2384 1392 2384 1376
WIRE 2400 1392 2384 1392
WIRE 2432 1392 2416 1392
WIRE 2448 1392 2432 1392
WIRE 2480 1392 2448 1392
WIRE 2576 1392 2544 1392
WIRE 2592 1392 2576 1392
WIRE 2608 1392 2592 1392
WIRE 2640 1392 2640 1200
WIRE 2640 1392 2624 1392
WIRE 3888 1392 3888 1360
WIRE 2928 1408 2928 1376
WIRE 2096 1424 2096 1408
WIRE 2128 1424 2128 1392
WIRE 2128 1424 2096 1424
WIRE 2224 1424 2224 1376
WIRE 2384 1424 2384 1392
WIRE 2400 1424 2400 1392
WIRE 2416 1424 2416 1392
WIRE 2432 1424 2432 1392
WIRE 2448 1424 2448 1392
WIRE 2576 1424 2576 1392
WIRE 2592 1424 2592 1392
WIRE 2608 1424 2608 1392
WIRE 2624 1424 2624 1392
WIRE 2640 1424 2640 1392
WIRE 2096 1440 2096 1424
WIRE 1328 1456 1328 1408
WIRE 3376 1456 3376 1344
WIRE 3840 1456 3840 1360
WIRE 3136 1472 3136 1392
WIRE 3200 1472 3136 1472
WIRE 3600 1472 3568 1472
WIRE 3808 1472 3600 1472
WIRE 3952 1488 3872 1488
WIRE 4128 1488 3952 1488
WIRE 4272 1488 4192 1488
WIRE 3808 1504 3696 1504
WIRE 2432 1552 2432 1488
WIRE 2480 1552 2544 1392
WIRE 2480 1552 2432 1552
WIRE 2544 1552 2480 1392
WIRE 2624 1552 2624 1488
WIRE 2624 1552 2544 1552
WIRE 2800 1552 2800 1328
WIRE 3136 1552 3136 1472
WIRE 3568 1552 3568 1472
WIRE 2224 1568 2224 1504
WIRE 3840 1584 3840 1520
WIRE 1488 1600 1488 1552
WIRE 3200 1600 2864 1600
WIRE 3376 1600 3376 1536
WIRE 3376 1600 3200 1600
WIRE 4272 1616 4272 1488
WIRE 2432 1632 2432 1552
WIRE 2624 1632 2624 1552
WIRE 1328 1648 1328 1536
WIRE 1424 1648 1328 1648
WIRE 2432 1648 2432 1632
WIRE 2624 1648 2624 1632
WIRE 3568 1648 3568 1616
WIRE 3696 1696 3696 1504
WIRE 3952 1696 3952 1488
WIRE 3952 1696 3696 1696
WIRE 1328 1712 1328 1648
WIRE 1632 1712 1632 1392
WIRE 2800 1712 2800 1648
WIRE 3136 1712 3136 1648
WIRE 3376 1712 3376 1600
WIRE 4272 1712 4272 1696
WIRE 1488 1760 1488 1696
WIRE 1488 1760 1392 1760
WIRE 1568 1760 1488 1760
WIRE 2736 1760 1568 1760
WIRE 3200 1760 2736 1760
WIRE 3312 1760 3200 1760
WIRE 2800 1840 2800 1808
WIRE 3136 1840 3136 1808
WIRE 1328 1856 1328 1808
WIRE 1632 1856 1632 1808
WIRE 3376 1856 3376 1808
WIRE 1328 1984 1328 1936
WIRE 1632 1984 1632 1936
WIRE 2800 2000 2800 1920
WIRE 3136 2000 3136 1920
WIRE 2752 2080 2640 2080
WIRE 3360 2080 3184 2080
WIRE 2800 2160 2800 2096
WIRE 3136 2160 3136 2096
FLAG 4032 192 0
FLAG 4912 176 0
FLAG 1232 -1840 VCC
FLAG 1232 -1520 VEE
FLAG 1568 -1840 5V
FLAG -720 128 0
FLAG 1568 -1520 -5V
FLAG 1696 -1616 0
FLAG 4864 32 Vo
FLAG 1408 -1520 -15V
FLAG 1408 -1840 15V
FLAG 1936 1312 Vcap
FLAG 1504 1200 0
FLAG 1328 1984 0
FLAG 1632 1984 0
FLAG 2928 1408 0
FLAG 2800 2160 0
FLAG 3136 2160 0
FLAG 3376 1856 0
FLAG 3568 1648 0
FLAG 3200 1472 Vcap
FLAG 3600 1472 Vcap
FLAG 2624 1632 Charge
FLAG 2432 1632 Discharge
FLAG 3360 2080 Discharge
FLAG 2640 2080 Charge
FLAG 1328 1408 VCC
FLAG 1488 1552 15V
FLAG 2224 1024 5V
FLAG 2224 1568 5V
FLAG 2096 1136 15V
FLAG 2096 1328 15V
FLAG 2096 1264 0
FLAG 2096 1440 0
FLAG 1728 992 0
FLAG 1696 1152 15V
FLAG 3136 864 15V
FLAG 1504 864 15V
FLAG 3840 1584 15V
FLAG 4272 1712 0
FLAG 3888 1392 0
FLAG -672 -48 Vsin
FLAG 4272 1488 Vtriang
FLAG 3216 -784 0
FLAG 144 -160 15V
FLAG 144 16 -15V
FLAG 0 144 0
FLAG 688 144 0
FLAG 3712 384 VEE
FLAG 3712 -256 VCC
FLAG 3264 -96 0
FLAG 3216 336 5V
FLAG 2048 176 0
FLAG 848 -64 error
SYMBOL ind 3856 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lf
SYMATTR Value 33µ
SYMBOL cap 4016 80 R0
SYMATTR InstName Cf
SYMATTR Value 330n
SYMBOL res 4896 32 R0
SYMATTR InstName RL
SYMATTR Value 8
SYMBOL voltage 1232 -1824 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VCC
SYMATTR Value 30
SYMBOL voltage 1232 -1648 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VSS
SYMATTR Value 30
SYMBOL voltage 1568 -1824 R0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL voltage -720 0 R0
WINDOW 3 -239 31 Left 2
WINDOW 0 -131 3 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value SINE(0 {vin} {freq})
SYMATTR InstName SENOIDAL
SYMBOL voltage 1568 -1648 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage 1408 -1824 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 15
SYMBOL voltage 1408 -1648 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 15
SYMBOL xcomp_x11 2096 1136 R0
SYMATTR InstName U1
SYMATTR Value LM311
SYMBOL xcomp_x11 2096 1312 R0
SYMATTR InstName U2
SYMATTR Value LM311
SYMBOL res 1616 1248 R0
SYMATTR InstName R1
SYMATTR Value 560
SYMBOL res 1792 1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 560
SYMBOL Opamps\\opamp2 1696 1136 M180
SYMATTR InstName U3
SYMATTR Value TL082
SYMBOL res 1488 1072 R0
SYMATTR InstName R3
SYMATTR Value 1Meg
SYMBOL res 1488 928 R0
SYMATTR InstName R4
SYMATTR Value 1Meg
SYMBOL npn 1568 1712 R0
SYMATTR InstName Q1
SYMATTR Value BC847C
SYMBOL npn 1392 1712 M0
SYMATTR InstName Q2
SYMATTR Value BC847C
SYMBOL npn 1424 1600 R0
SYMATTR InstName Q3
SYMATTR Value BC847C
SYMBOL res 1312 1440 R0
SYMATTR InstName R5
SYMATTR Value 12k
SYMBOL res 1312 1840 R0
SYMATTR InstName R6
SYMATTR Value 100
SYMBOL res 1616 1840 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL res 2208 1072 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL res 2208 1408 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL Digital\\or 2352 1456 M90
WINDOW 3 -8 36 Left 2
SYMATTR Value Vhigh=5  td=11n
SYMATTR InstName A1
SYMBOL Digital\\or 2544 1456 M90
WINDOW 3 -8 36 Left 2
SYMATTR Value Vhigh=5  td=11n
SYMATTR InstName A2
SYMBOL npn 2736 1712 R0
SYMATTR InstName Q4
SYMATTR Value BC847C
SYMBOL npn 3200 1712 M0
SYMATTR InstName Q5
SYMATTR Value BC847C
SYMBOL npn 2864 1552 M0
SYMATTR InstName Q6
SYMATTR Value BC847C
SYMBOL npn 3200 1552 M0
SYMATTR InstName Q7
SYMATTR Value BC847C
SYMBOL pnp 2864 1248 R180
SYMATTR InstName Q8
SYMATTR Value BC857C
SYMBOL pnp 3200 1392 R180
SYMATTR InstName Q9
SYMATTR Value BC857C
SYMBOL pnp 2864 1376 M180
SYMATTR InstName Q10
SYMATTR Value BC857C
SYMBOL pnp 3312 1808 M180
SYMATTR InstName Q11
SYMATTR Value BC857C
SYMBOL pnp 3072 1248 M180
SYMATTR InstName Q12
SYMATTR Value BC857C
SYMBOL res 3360 1440 R0
SYMATTR InstName R10
SYMATTR Value 3.3k
SYMBOL npn 3312 1152 R0
SYMATTR InstName BC1
SYMBOL res 2784 1008 R0
SYMATTR InstName R11
SYMATTR Value 100
SYMBOL res 3120 1008 R0
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL res 2784 1824 R0
SYMATTR InstName R13
SYMATTR Value 100
SYMBOL res 3120 1824 R0
SYMATTR InstName R14
SYMATTR Value 100
SYMBOL nmos 2752 2000 R0
SYMATTR InstName M3
SYMATTR Value BS170
SYMBOL nmos 3184 2000 M0
SYMATTR InstName M4
SYMATTR Value BS170
SYMBOL cap 3552 1552 R0
SYMATTR InstName C1
SYMATTR Value 1.8n
SYMBOL Opamps\\opamp2 3840 1552 M180
SYMATTR InstName U5
SYMATTR Value TL082
SYMBOL res 4256 1600 R0
SYMATTR InstName R15
SYMATTR Value 1.8k
SYMBOL cap 4192 1472 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMATTR SpiceLine IC=-7.5
SYMBOL res 3344 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 18k
SYMBOL res 3232 -816 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL Opamps\\opamp2 144 -128 R0
SYMATTR InstName U8
SYMATTR Value AD817
SYMBOL res 16 -384 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value 100
SYMBOL res -64 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 100
SYMBOL res 16 112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R21
SYMATTR Value {R}
SYMBOL res 80 -272 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R22
SYMATTR Value {R}
SYMBOL cap 3376 -1136 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 82p
SYMBOL res 3488 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 624 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 10k
SYMBOL cap 592 -160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C12
SYMATTR Value 100p
SYMBOL res 672 -16 R0
SYMATTR InstName R26
SYMATTR Value 1k
SYMBOL sw 3392 -128 M180
SYMATTR InstName S1
SYMBOL sw 3392 176 R0
SYMATTR InstName S2
SYMBOL bv 2048 16 R0
SYMATTR InstName B1
SYMATTR Value V(if( V(error) > V(Vtriang), 5, 0))
TEXT 2128 -1536 Left 2 !.include UCC20520.301
TEXT 1088 -2008 Left 2 ;Fuentes
TEXT 2120 -1624 Left 2 ;Bibliotecas
TEXT 4784 -176 Left 6 ;Salida
TEXT 3952 312 Left 4 ;Filtro
TEXT 2128 -1568 Left 2 !.include PHB27NQ10T.lib
TEXT 2128 -1504 Left 2 !.include BS170.301\n.include LM311.301
TEXT 3000 -2016 Left 2 ;Directivas SPICE
TEXT 1072 2176 Left 6 ;Generador de onda triangular
TEXT -912 -216 Left 6 ;Entrada
TEXT 3664 608 Left 6 ;Etapa de salida
TEXT 2128 -1824 Left 2 !.options numdgt = 15
TEXT 2448 -1824 Left 2 ;Doble precision
TEXT 2128 -1800 Left 2 !.options plotwinsize = 0
TEXT 2448 -1800 Left 2 ;Deshabilitar la compresion
TEXT 3552 -1944 Left 2 !.param freq=20k
TEXT 2128 -1872 Left 2 !.param time=10/{freq}+200u
TEXT 3552 -1920 Left 2 !.param R=470k
TEXT 2128 -1896 Left 2 !.tran 0 {time} 200u uic
TEXT 2128 -1920 Left 2 !.four {freq} {Narm} -1 V(vo)
TEXT 2128 -1448 Left 2 !.include AD817.301
TEXT 2128 -1416 Left 2 !.include TL082.301
TEXT 2128 -1848 Left 2 !.param Narm table(freq, 1k, 9, 10k, 6, 20k, 3)
TEXT 2656 -1848 Left 2 ;Numero de armonicos segun frecuencia
TEXT 2520 -1872 Left 2 ;Tiempo de simulacion para 10 períodos
TEXT 2136 -1952 Left 2 ;NO TOCAR ESTAS DIRECTIVAS
TEXT 3760 -1920 Left 2 ;Resistencias del amplificador de error. La ganancia es R/100
TEXT 3760 -1944 Left 2 ;Frecuencia de entrada
TEXT 3552 -1968 Left 2 !.param vin=1.1
TEXT 3760 -1968 Left 2 ;Tension de entrada pico a pico
TEXT 2384 -1416 Left 2 !.model SW SW(Ron=.01 Roff=10Meg Vt=1)
RECTANGLE Normal 1040 -2032 1792 -1376
RECTANGLE Normal 2912 -1648 2096 -1360
RECTANGLE Normal 5168 480 4672 -352
RECTANGLE Normal 4784 -1680 2096 -2032
RECTANGLE Normal 4480 2256 992 768
RECTANGLE Normal 4192 368 3808 -128
RECTANGLE Normal -560 224 -960 -320
RECTANGLE Normal 4432 704 1040 -416
