Version 4
SHEET 1 8704 3776
WIRE 1232 -1808 1232 -1840
WIRE 1408 -1808 1408 -1840
WIRE 1568 -1808 1568 -1840
WIRE 1232 -1664 1232 -1728
WIRE 1408 -1664 1408 -1728
WIRE 1408 -1664 1232 -1664
WIRE 1568 -1664 1568 -1728
WIRE 1568 -1664 1408 -1664
WIRE 1696 -1664 1568 -1664
WIRE 1232 -1632 1232 -1664
WIRE 1408 -1632 1408 -1664
WIRE 1568 -1632 1568 -1664
WIRE 1696 -1616 1696 -1664
WIRE 1232 -1520 1232 -1552
WIRE 1408 -1520 1408 -1552
WIRE 1568 -1520 1568 -1552
WIRE 2304 -1200 1984 -1200
WIRE 2208 -1040 2208 -1104
WIRE 2304 -1024 2304 -1200
WIRE 2304 -1024 2240 -1024
WIRE 1984 -1008 1984 -1200
WIRE 1984 -1008 0 -1008
WIRE 2176 -1008 1984 -1008
WIRE 3216 -992 2240 -992
WIRE 3248 -992 3216 -992
WIRE 3392 -992 3328 -992
WIRE 3776 -992 3472 -992
WIRE 2208 -928 2208 -976
WIRE 3216 -912 3216 -992
WIRE 3216 -784 3216 -832
WIRE 0 -480 0 -1008
WIRE 0 -384 0 -400
WIRE 96 -384 0 -384
WIRE 304 -384 160 -384
WIRE 0 -288 0 -384
WIRE 96 -288 0 -288
WIRE 304 -288 304 -384
WIRE 304 -288 176 -288
WIRE 3552 -288 3392 -288
WIRE 3680 -288 3552 -288
WIRE 3072 -240 3056 -240
WIRE 3200 -240 3152 -240
WIRE 3280 -240 3264 -240
WIRE 3392 -240 3392 -288
WIRE 1456 -192 1456 -240
WIRE 3552 -192 3552 -288
WIRE 3056 -160 3056 -240
WIRE 3056 -160 2992 -160
WIRE 3152 -160 3056 -160
WIRE 3280 -160 3280 -240
WIRE 3280 -160 3232 -160
WIRE 3344 -160 3280 -160
WIRE 1312 -112 1312 -160
WIRE 144 -96 144 -160
WIRE 1024 -96 992 -96
WIRE 1280 -96 1024 -96
WIRE 3280 -96 3280 -160
WIRE 0 -80 0 -288
WIRE 112 -80 0 -80
WIRE 1456 -80 1456 -112
WIRE 1456 -80 1344 -80
WIRE 1680 -80 1456 -80
WIRE 1872 -80 1760 -80
WIRE 1952 -80 1872 -80
WIRE 2176 -80 1952 -80
WIRE 2624 -80 2416 -80
WIRE 2720 -80 2624 -80
WIRE 2848 -80 2720 -80
WIRE 304 -64 304 -288
WIRE 304 -64 176 -64
WIRE 848 -64 304 -64
WIRE 1280 -64 848 -64
WIRE -672 -48 -720 -48
WIRE -432 -48 -672 -48
WIRE -176 -48 -352 -48
WIRE 0 -48 -176 -48
WIRE 112 -48 0 -48
WIRE 1872 -48 1872 -80
WIRE 2512 -48 2416 -48
WIRE 2528 -48 2512 -48
WIRE 2624 -48 2624 -80
WIRE 2720 -48 2720 -80
WIRE 1344 -16 1344 -64
WIRE 2080 -16 2064 -16
WIRE 2176 -16 2080 -16
WIRE 2448 -16 2416 -16
WIRE -720 16 -720 -48
WIRE 0 16 0 -48
WIRE 144 16 144 -32
WIRE 2176 16 1968 16
WIRE -176 32 -176 -48
WIRE 1312 32 1312 -48
WIRE 2448 32 2448 -16
WIRE 2624 32 2624 16
WIRE 2624 32 2448 32
WIRE 2720 32 2720 16
WIRE 2720 32 2624 32
WIRE 3280 32 3280 -32
WIRE 3280 32 2720 32
WIRE 3392 32 3392 -144
WIRE 3392 32 3280 32
WIRE 3552 32 3552 -128
WIRE 3552 32 3392 32
WIRE 3776 32 3776 -992
WIRE 3776 32 3552 32
WIRE 3872 32 3776 32
WIRE 4032 32 3952 32
WIRE 4864 32 4032 32
WIRE 4912 32 4864 32
WIRE 1968 48 1968 16
WIRE 2176 48 1968 48
WIRE 4912 48 4912 32
WIRE 2080 80 2064 80
WIRE 2176 80 2080 80
WIRE 2624 80 2416 80
WIRE 2848 80 2848 -16
WIRE 3072 80 3056 80
WIRE 3200 80 3152 80
WIRE 3280 80 3264 80
WIRE 3392 80 3392 32
WIRE 4032 80 4032 32
WIRE 1872 96 1872 16
WIRE 2512 112 2416 112
WIRE 2528 112 2512 112
WIRE -720 128 -720 96
WIRE -176 144 -176 96
WIRE 0 144 0 96
WIRE 2080 144 2064 144
WIRE 2176 144 2080 144
WIRE 2448 144 2416 144
WIRE 3056 160 3056 80
WIRE 3056 160 2992 160
WIRE 3152 160 3056 160
WIRE 3280 160 3280 80
WIRE 3280 160 3232 160
WIRE 3344 160 3280 160
WIRE 2064 176 2064 144
WIRE 4912 176 4912 128
WIRE 4032 192 4032 144
WIRE 2624 208 2624 80
WIRE 2624 208 2544 208
WIRE 2720 208 2624 208
WIRE 2848 208 2848 160
WIRE 2848 208 2720 208
WIRE 3280 224 3280 160
WIRE 3552 224 3552 32
WIRE 2848 240 2848 208
WIRE 2544 256 2544 208
WIRE 2624 256 2624 208
WIRE 2720 256 2720 208
WIRE 1968 272 1968 48
WIRE 2064 272 2064 240
WIRE 2448 352 2448 144
WIRE 2544 352 2544 320
WIRE 2544 352 2448 352
WIRE 2624 352 2624 320
WIRE 2624 352 2544 352
WIRE 2720 352 2720 320
WIRE 2720 352 2624 352
WIRE 2848 352 2848 320
WIRE 2848 352 2720 352
WIRE 3280 352 3280 288
WIRE 3280 352 2848 352
WIRE 3392 352 3392 176
WIRE 3392 352 3280 352
WIRE 3552 352 3552 288
WIRE 3552 352 3392 352
WIRE 3680 352 3552 352
WIRE 288 384 128 384
WIRE 304 384 288 384
WIRE 1280 416 1184 416
WIRE 1328 416 1280 416
WIRE 1344 416 1328 416
WIRE 1280 448 1280 416
WIRE 1184 464 1184 416
WIRE 128 480 128 384
WIRE 1184 544 1184 528
WIRE 1280 544 1280 528
WIRE 128 608 128 560
FLAG 4912 176 0
FLAG 1232 -1840 VCC
FLAG 1232 -1520 VEE
FLAG 1568 -1840 5V
FLAG -720 128 0
FLAG 1568 -1520 -5V
FLAG 1696 -1616 0
FLAG 4864 32 Vo
FLAG 1408 -1520 -15V
FLAG 1408 -1840 15V
FLAG -672 -48 Vsin
FLAG 3216 -784 0
FLAG 144 -160 15V
FLAG 144 16 -15V
FLAG 0 144 0
FLAG 848 -64 error
FLAG 4032 192 0
FLAG 3680 352 VEE
FLAG 3680 -288 VCC
FLAG 1968 272 0
FLAG 2080 -16 5V
FLAG 2080 144 5V
FLAG 2512 -48 HO
FLAG 2512 112 LO
FLAG 2992 -160 HO
FLAG 2992 160 LO
FLAG 1184 544 0
FLAG 1280 544 0
FLAG 2080 80 DT
FLAG 1328 416 DT
FLAG 1872 96 0
FLAG 1952 -80 PWM-In
FLAG 2064 272 0
FLAG 1312 -160 15V
FLAG 1312 32 -15V
FLAG 1344 -16 0
FLAG 1456 -240 5V
FLAG 1024 -96 Vtriang
FLAG 2208 -1104 15V
FLAG 2208 -928 -15V
FLAG 128 608 0
FLAG 288 384 Vtriang
FLAG -176 144 0
SYMBOL res 4896 32 R0
SYMATTR InstName RL
SYMATTR Value 8
SYMBOL voltage 1232 -1824 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VCC
SYMATTR Value 30
SYMBOL voltage 1232 -1648 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VSS
SYMATTR Value 30
SYMBOL voltage 1568 -1824 R0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL voltage -720 0 R0
WINDOW 3 -239 31 Left 2
WINDOW 0 -131 3 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value SINE(0 {vin} {freq})
SYMATTR InstName SENOIDAL
SYMBOL voltage 1568 -1648 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage 1408 -1824 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 15
SYMBOL voltage 1408 -1648 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 15
SYMBOL res 3344 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 18k
SYMBOL res 3232 -816 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL Opamps\\opamp2 144 -128 R0
SYMATTR InstName U8
SYMATTR Value AD817
SYMBOL res 16 -384 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL res -336 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 16 112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R21
SYMATTR Value {R}
SYMBOL res 80 -272 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R22
SYMATTR Value {R}
SYMBOL res 3488 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res 2832 64 R0
SYMATTR InstName R16
SYMATTR Value 10
SYMBOL diode 2864 -16 R180
WINDOW 0 -45 51 Left 2
WINDOW 3 -101 5 Left 2
SYMATTR InstName D1
SYMATTR Value MURS120
SYMBOL cap 2608 -48 R0
WINDOW 3 39 42 Top 2
WINDOW 0 0 8 Left 2
SYMATTR Value 1µ
SYMATTR InstName C3
SYMBOL nmos 3344 -240 R0
SYMATTR InstName M1
SYMATTR Value PHB27NQ10T
SYMATTR Prefix X
SYMBOL nmos 3344 80 R0
SYMATTR InstName M2
SYMATTR Value PHB27NQ10T
SYMATTR Prefix X
SYMBOL cap 2608 256 R0
WINDOW 0 -19 0 Left 2
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL ind 3856 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lf1
SYMATTR Value 33µ
SYMBOL cap 4016 80 R0
SYMATTR InstName Cf1
SYMATTR Value 300n
SYMBOL UCC20520 2288 32 R0
SYMATTR InstName U4
SYMBOL voltage 2848 224 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 12
SYMBOL cap 1168 464 R0
SYMATTR InstName C6
SYMATTR Value 2.2n
SYMBOL res 1264 432 R0
SYMATTR InstName R25
SYMATTR Value 2.2k
SYMBOL res 1776 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 51
SYMBOL cap 1856 -48 R0
SYMATTR InstName C7
SYMATTR Value 33p
SYMBOL cap 2048 176 R0
SYMATTR InstName C8
SYMATTR Value 1µ
SYMBOL cap 2704 -48 R0
WINDOW 0 5 8 Left 2
SYMATTR InstName C9
SYMATTR Value 100n
SYMBOL cap 2704 256 R0
SYMATTR InstName C10
SYMATTR Value 220n
SYMBOL cap 2528 256 R0
WINDOW 0 -27 -4 Left 2
SYMATTR InstName C11
SYMATTR Value 10µ
SYMBOL res 3248 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 3.3
SYMBOL res 3248 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 3.3
SYMBOL diode 3264 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value MURS320
SYMBOL res 3168 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 1.2
SYMBOL res 3168 -256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 1.2
SYMBOL diode 3264 -256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value MURS320
SYMBOL cap 3264 224 R0
SYMATTR InstName C13
SYMATTR Value 1n
SYMBOL cap 3264 -96 R0
SYMATTR InstName C14
SYMATTR Value 1n
SYMBOL xcomp_x11 1312 -144 R0
SYMATTR InstName U6
SYMATTR Value LM311
SYMBOL res 1440 -208 R0
SYMATTR InstName R32
SYMATTR Value 1k
SYMBOL Opamps\\opamp2 2208 -1072 M0
SYMATTR InstName U7
SYMATTR Value AD817
SYMBOL voltage 128 464 R0
SYMATTR InstName V4
SYMATTR Value PULSE(-1.5 1.5 0 2.5u 2.5u 0 5u)
SYMBOL cap 160 -400 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {C}
SYMBOL cap -192 32 R0
SYMATTR InstName C2
SYMATTR Value {C}
TEXT 2128 -1536 Left 2 !.include UCC20520.301
TEXT 1088 -2008 Left 2 ;Fuentes
TEXT 2120 -1624 Left 2 ;Bibliotecas
TEXT 4784 -176 Left 6 ;Salida
TEXT 2128 -1568 Left 2 !.include PHB27NQ10T.lib
TEXT 2128 -1504 Left 2 !.include BS170.301\n.include LM311.301
TEXT 3000 -2016 Left 2 ;Directivas SPICE
TEXT -912 -216 Left 6 ;Entrada
TEXT 3664 608 Left 6 ;Etapa de salida
TEXT 2128 -1856 Left 2 !.options numdgt = 15
TEXT 2448 -1856 Left 2 ;Doble precision
TEXT 2128 -1832 Left 2 !.options plotwinsize = 0
TEXT 2448 -1832 Left 2 ;Deshabilitar la compresion
TEXT 3552 -1944 Left 2 !.param freq=20k
TEXT 2128 -1736 Left 2 !.param time=500u+10/{freq}
TEXT 2128 -1896 Left 2 !.tran 0 {time} 500u uic
TEXT 2128 -1920 Left 2 !.four {freq} {Narm} -1 V(vo)
TEXT 2128 -1448 Left 2 !.include AD817.301
TEXT 2128 -1416 Left 2 !.include TL082.301
TEXT 2128 -1712 Left 2 !.param Narm table(freq, 1k, 9, 10k, 6, 20k, 3)
TEXT 2656 -1712 Left 2 ;Numero de armonicos segun frecuencia
TEXT 2520 -1736 Left 2 ;Tiempo de simulacion para 10 períodos
TEXT 2136 -1952 Left 2 ;NO TOCAR ESTAS DIRECTIVAS
TEXT 3760 -1920 Left 2 ;Resistencias del amplificador de error. La ganancia es R/100
TEXT 3760 -1944 Left 2 ;Frecuencia de entrada
TEXT 3552 -1968 Left 2 !.param vin=1.1
TEXT 3760 -1968 Left 2 ;Tension de entrada pico a pico
TEXT 1240 328 Left 2 ;Dead-Time
TEXT 1208 176 Left 4 ;Generador PWM
TEXT 2024 320 Left 2 ;Tantalio > 1u, 50V
TEXT 2024 344 Left 2 ;Hoja de datos, página 28
TEXT 2472 -296 Left 2 ;C-BOOT > (Qg + Ivdd/fsw)/0.5
TEXT 2472 -328 Left 2 ;Bootstrap
TEXT 2472 -272 Left 2 ;1u, 50V
TEXT 2472 -248 Left 2 ;Lo mas cerca posible de Vdd, Vss
TEXT 2472 -224 Left 2 ;C-AC para reducir impedancia en AC
TEXT 2472 -200 Left 2 ;Hoja de datos, página 28
TEXT 2456 488 Left 2 ;Cvdd tambien entrega corriente a VDDA a traves de D1
TEXT 2456 512 Left 2 ;C-VDDB: 50V, 10u MLCC\nC-VDDB2: 50V, 220n MLCC
TEXT 2456 568 Left 2 ;C-LONG: 50V, 10u Electrolitico o Tantalio. \nSolo es necesario si las fuentes estan lejos de VDDB
TEXT 1672 184 Left 2 ;Filtro para ruido de PCB
TEXT 2456 624 Left 2 ;Hoja de datos, página 29
TEXT 1672 208 Left 2 ;Hoja de datos, página 24
TEXT 3952 312 Left 4 ;Filtro
TEXT 3664 608 Left 6 ;Etapa de salida
TEXT 80 -560 Left 2 !.param R=8.2k
TEXT 80 -504 Left 2 !.param C=220p
TEXT 80 -536 Left 2 !.param fc=100k
LINE Normal 2560 48 2560 -144 2
LINE Normal 2784 48 2560 48 2
LINE Normal 2784 -144 2784 48 2
LINE Normal 2928 -144 2784 -144 2
LINE Normal 2928 -368 2928 -144 2
LINE Normal 2448 -368 2928 -368 2
LINE Normal 2448 -144 2448 -368 2
LINE Normal 2560 -144 2448 -144 2
LINE Normal 2512 432 2512 192 2
LINE Normal 2416 432 2512 432 2
LINE Normal 2416 640 2416 432 2
LINE Normal 3104 640 2416 640 2
LINE Normal 3104 448 3104 640 2
LINE Normal 3104 432 3104 448 2
LINE Normal 2784 432 3104 432 2
LINE Normal 2784 176 2784 432 2
LINE Normal 2512 176 2784 176 2
LINE Normal 2512 192 2512 176 2
RECTANGLE Normal 1040 -2032 1792 -1376
RECTANGLE Normal 2912 -1648 2096 -1360
RECTANGLE Normal 5168 480 4672 -352
RECTANGLE Normal 4784 -1680 2096 -2032
RECTANGLE Normal -560 224 -960 -320
RECTANGLE Normal 4432 704 1040 -416
RECTANGLE Normal 1424 640 1152 304 2
RECTANGLE Normal 2336 384 2016 160 2
RECTANGLE Normal 1952 224 1648 -176 2
RECTANGLE Normal 1600 224 1168 -304
RECTANGLE Normal 4192 368 3808 -128
