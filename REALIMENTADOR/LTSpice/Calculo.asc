Version 4
SHEET 1 6008 3028
WIRE 1792 112 1712 112
WIRE 1952 112 1856 112
WIRE 992 192 976 192
WIRE 1152 192 1072 192
WIRE 1376 192 1152 192
WIRE 1568 208 1440 208
WIRE 1584 208 1568 208
WIRE 1712 208 1712 112
WIRE 1712 208 1584 208
WIRE 1776 208 1712 208
WIRE 1952 208 1952 112
WIRE 1952 208 1856 208
WIRE 2080 208 1952 208
WIRE 2336 208 2080 208
WIRE 2864 208 2640 208
WIRE 3024 208 2944 208
WIRE 3280 208 3024 208
WIRE 1152 224 1152 192
WIRE 1376 224 1328 224
WIRE 3024 256 3024 208
WIRE 3280 256 3280 208
WIRE 976 272 976 192
WIRE 1952 272 1952 208
WIRE 2640 272 2640 208
WIRE 1152 336 1152 304
WIRE 1328 352 1328 224
WIRE 1360 352 1328 352
WIRE 1568 352 1568 208
WIRE 1568 352 1440 352
WIRE 3024 368 3024 320
WIRE 3280 368 3280 336
WIRE 1328 384 1328 352
WIRE 2640 400 2640 352
WIRE 1952 432 1952 352
WIRE 1776 608 1680 608
WIRE 1904 608 1840 608
WIRE 1328 720 1328 464
WIRE 1360 720 1328 720
WIRE 1680 720 1680 608
WIRE 1680 720 1360 720
WIRE 1760 720 1680 720
WIRE 1904 720 1904 608
WIRE 1904 720 1840 720
WIRE 1984 720 1904 720
WIRE 2032 720 1984 720
WIRE 1680 752 1680 720
WIRE 672 816 672 800
WIRE 816 816 816 800
WIRE 816 816 672 816
WIRE 880 816 816 816
WIRE 960 816 960 800
WIRE 960 816 880 816
WIRE 1024 816 960 816
WIRE 2032 816 2032 720
WIRE 672 848 672 816
WIRE 816 848 816 816
WIRE 880 848 880 816
WIRE 960 848 960 816
WIRE 1024 848 1024 816
WIRE 1680 864 1680 832
WIRE 2032 928 2032 896
WIRE 2032 1104 1952 1104
WIRE 2192 1104 2096 1104
WIRE 3360 1104 3280 1104
WIRE 3520 1104 3424 1104
WIRE 1024 1184 912 1184
WIRE 1184 1184 1104 1184
WIRE 1552 1184 1184 1184
WIRE 2192 1184 2192 1104
WIRE 3520 1184 3520 1104
WIRE 1744 1200 1616 1200
WIRE 1952 1200 1952 1104
WIRE 2016 1200 1952 1200
WIRE 2192 1200 2192 1184
WIRE 2192 1200 2096 1200
WIRE 2608 1200 2384 1200
WIRE 2768 1200 2688 1200
WIRE 2832 1200 2768 1200
WIRE 2944 1200 2832 1200
WIRE 3280 1200 3280 1104
WIRE 3344 1200 3280 1200
WIRE 3520 1200 3520 1184
WIRE 3520 1200 3424 1200
WIRE 1184 1216 1184 1184
WIRE 1552 1216 1504 1216
WIRE 912 1248 912 1184
WIRE 2768 1248 2768 1200
WIRE 2944 1248 2944 1200
WIRE 2192 1264 2192 1200
WIRE 3520 1264 3520 1200
WIRE 1952 1280 1952 1200
WIRE 2384 1280 2384 1200
WIRE 3280 1280 3280 1200
WIRE 1184 1328 1184 1296
WIRE 1504 1344 1504 1216
WIRE 1536 1344 1504 1344
WIRE 1744 1344 1744 1200
WIRE 1744 1344 1616 1344
WIRE 2768 1360 2768 1312
WIRE 1504 1376 1504 1344
WIRE 2944 1376 2944 1328
WIRE 912 1392 912 1328
WIRE 1952 1392 1952 1360
WIRE 2384 1392 2384 1360
WIRE 3280 1392 3280 1360
WIRE 2192 1424 2192 1344
WIRE 3520 1424 3520 1344
WIRE 1504 1520 1504 1456
WIRE 1872 1584 1776 1584
WIRE 2000 1584 1936 1584
WIRE 1776 1696 1776 1584
WIRE 1856 1696 1776 1696
WIRE 2000 1696 2000 1584
WIRE 2000 1696 1936 1696
WIRE 2272 1696 2000 1696
WIRE 2272 1712 2272 1696
WIRE 1776 1728 1776 1696
WIRE 2272 1824 2272 1792
WIRE 1776 1840 1776 1808
FLAG 1024 848 0
FLAG 960 928 -5V
FLAG 960 720 5V
FLAG 1152 336 0
FLAG 1408 240 15V
FLAG 1408 176 -15V
FLAG 3024 368 0
FLAG 3024 208 vo
FLAG 1584 208 error
FLAG 3280 368 0
FLAG 1680 864 0
FLAG 1952 432 0
FLAG 880 848 0
FLAG 816 928 -15V
FLAG 816 720 15V
FLAG 672 928 VEE
FLAG 672 720 VCC
FLAG 2032 928 0
FLAG 1360 720 Vf
FLAG 976 272 0
FLAG 2640 400 0
FLAG 1984 720 vin
FLAG 2272 1824 0
FLAG 1776 1840 0
FLAG 2192 1424 0
FLAG 1952 1392 0
FLAG 1184 1328 0
FLAG 1584 1232 15V
FLAG 1584 1168 -15V
FLAG 1504 1520 0
FLAG 2768 1360 0
FLAG 2384 1392 0
FLAG 2944 1376 0
FLAG 2080 208 comp
FLAG 2192 1184 t_comp
FLAG 1776 1696 t_f
FLAG 912 1392 0
FLAG 1744 1200 t_error
FLAG 2832 1200 t_vo
FLAG 3520 1424 0
FLAG 3280 1392 0
FLAG 3520 1184 t_comp2
SYMBOL voltage 960 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL voltage 960 832 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL Opamps\\opamp2 1408 272 M180
SYMATTR InstName U1
SYMATTR Value AD817
SYMBOL res 1088 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res 1168 320 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value {R}
SYMBOL res 1456 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R}
SYMBOL res 1344 480 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL ind 2848 224 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lf1
SYMATTR Value 33µ
SYMBOL cap 3008 256 R0
SYMATTR InstName Cf1
SYMATTR Value 330n
SYMBOL res 3264 240 R0
SYMATTR InstName R5
SYMATTR Value 8
SYMBOL res 1744 704 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 19k
SYMBOL res 1664 848 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL cap 1776 592 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 82p
SYMBOL res 1872 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL cap 1856 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100p
SYMBOL res 1936 256 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL voltage 816 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value 15
SYMBOL voltage 816 832 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value 15
SYMBOL voltage 672 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value 30
SYMBOL voltage 672 832 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V11
SYMATTR Value 30
SYMBOL voltage 2032 800 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V4
SYMATTR Value ""
SYMBOL bv 2640 256 R0
SYMATTR InstName B1
SYMATTR Value V=delay(V(comp), 300n)*20
SYMBOL voltage 2272 1696 M0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V3
SYMATTR Value ""
SYMBOL res 1840 1680 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 19k
SYMBOL res 1760 1824 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL cap 1872 1568 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 82p
SYMBOL res 2112 1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL cap 2096 1088 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 100p
SYMBOL res 2176 1248 R0
SYMATTR InstName R13
SYMATTR Value 1k
SYMBOL voltage 1952 1264 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V5
SYMATTR Value ""
SYMBOL Opamps\\opamp2 1584 1264 M180
SYMATTR InstName U2
SYMATTR Value AD817
SYMBOL res 1120 1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res 1200 1312 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 1Meg
SYMBOL res 1632 1328 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1Meg
SYMBOL res 1520 1472 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 1k
SYMBOL voltage 912 1232 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V6
SYMATTR Value ""
SYMBOL ind 2592 1216 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lf2
SYMATTR Value 33µ
SYMBOL cap 2752 1248 R0
SYMATTR InstName Cf2
SYMATTR Value 330n
SYMBOL voltage 2384 1264 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 20
SYMATTR InstName V7
SYMATTR Value ""
SYMBOL res 2928 1232 R0
SYMATTR InstName R18
SYMATTR Value 8
SYMBOL res 3440 1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL cap 3424 1088 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 100p
SYMBOL res 3504 1248 R0
SYMATTR InstName R22
SYMATTR Value 8.2k
SYMBOL voltage 3280 1264 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V12
SYMATTR Value ""
TEXT 976 -48 Left 2 !.ac dec 10000 0.1 10Meg
TEXT 976 -120 Left 2 !.include AD817.301
TEXT 976 -72 Left 2 !.param R=470k
TEXT 976 -144 Left 2 !.include LM311.301
TEXT 976 -168 Left 2 !.options plotwinsize = 0
TEXT 976 -192 Left 2 !.options numdgt = 15
TEXT 976 -96 Left 2 !.model SW SW(Ron=.01 Roff=10Meg Vt=1)
